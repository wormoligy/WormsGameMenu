// ==UserScript==
// @name         Mini FPS Sprite Game
// @namespace    http://tampermonkey.net/
// @version      1.0
// @description  Basic FPS-like sprite overlay with GitHub image
// @match        *://*/*
// @grant        none
// ==/UserScript==

(function () {
  'use strict';

  const SPRITE_URL = "https://raw.githubusercontent.com/wormoligy/WormsGameMenu/main/pixil-frame-0.png";

  // Create overlay
  const overlay = document.createElement('div');
  overlay.style.position = 'fixed';
  overlay.style.top = 0;
  overlay.style.left = 0;
  overlay.style.width = '100vw';
  overlay.style.height = '100vh';
  overlay.style.background = '#222';
  overlay.style.zIndex = '999999';
  overlay.style.display = 'none';
  overlay.style.overflow = 'hidden';
  document.body.appendChild(overlay);

  // Add player sprite
  const player = document.createElement('img');
  player.src = SPRITE_URL;
  player.style.position = 'absolute';
  player.style.width = '64px';
  player.style.height = '64px';
  player.style.transformOrigin = 'center center';
  overlay.appendChild(player);

  // Initial position and rotation
  let x = window.innerWidth / 2;
  let y = window.innerHeight / 2;
  let angle = 0;
  const speed = 10;

  function updatePosition() {
    player.style.left = `${x}px`;
    player.style.top = `${y}px`;
    player.style.transform = `translate(-50%, -50%) rotate(${angle}deg)`;
  }
  updatePosition();

  // Listen for keys
  window.addEventListener('keydown', (e) => {
    // Toggle overlay
    if (e.ctrlKey && e.key.toLowerCase() === 'm') {
      overlay.style.display = overlay.style.display === 'none' ? 'block' : 'none';
      return;
    }

    if (overlay.style.display === 'none') return; // ignore if game is closed

    switch (e.key.toLowerCase()) {
      case 'w':
        // Move forward in facing direction
        x += Math.cos(angle * Math.PI / 180) * speed;
        y += Math.sin(angle * Math.PI / 180) * speed;
        break;
      case 'a':
        // Turn left
        angle -= 10;
        break;
      case 'd':
        // Turn right
        angle += 10;
        break;
      case ' ':
        shoot();
        break;
    }
    updatePosition();
  });

  // Basic shooting effect
  function shoot() {
    const bullet = document.createElement('div');
    bullet.style.position = 'absolute';
    bullet.style.width = '10px';
    bullet.style.height = '10px';
    bullet.style.background = 'red';
    bullet.style.borderRadius = '50%';
    bullet.style.left = `${x}px`;
    bullet.style.top = `${y}px`;
    bullet.style.transform = 'translate(-50%, -50%)';
    overlay.appendChild(bullet);

    let dist = 0;
    const bulletSpeed = 20;
    const interval = setInterval(() => {
      dist += bulletSpeed;
      bullet.style.left = `${x + Math.cos(angle * Math.PI / 180) * dist}px`;
      bullet.style.top = `${y + Math.sin(angle * Math.PI / 180) * dist}px`;

      // Remove if off screen
      if (
        parseInt(bullet.style.left) < 0 ||
        parseInt(bullet.style.top) < 0 ||
        parseInt(bullet.style.left) > window.innerWidth ||
        parseInt(bullet.style.top) > window.innerHeight
      ) {
        clearInterval(interval);
        bullet.remove();
      }
    }, 30);
  }
})();
